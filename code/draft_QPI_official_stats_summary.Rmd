---
output: 
  word_document:
    reference_docx: "phs-offstats-summary.docx"
    fig_caption: no
---


```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE, dpi = 300)
library(ggplot2)
library(here)
library(openxlsx)
library(dplyr)
library(tidyr)
library(officer)
library(flextable) # takes ages to load

# source doesn't seem to work - run this manually in the console before knitting 
# source("code/functions.R")




```

<Div custom-style = "Publication Title">Endometrial cancer QPIs 20 Summary Publication</Div>
<Div custom-style = "Publication subtitle">Quality Performance Indicators</Div>
<Div custom-style = "Stats designation">An Official statistics release for Scotland</Div>
<Div custom-style = "Publication date">Publication date: DD Month YYYY</Div>
<Div custom-style = "Restricted Stats">Unduly RESTRICTED STATISTICS: embargoed to 09:30 dd/mm/yyyy</Div>

# About this release
Vestibulum lacinia, turpis eu sagittis lacinia, justo orci blandit orci, ut suscipit tortor turpis et metus. Pellentesque sollicitudin nisl et porttitor laoreet. Nunc id purus pretium, suscipit justo vitae, pretium dui. Quisque congue ex dignissim tellus pulvinar, a interdum libero fermentum.

# Main Points
Proin nec ultricies dolor. Maecenas pulvinar, enim et imperdiet cursus, mi

<Div custom-style = "Bullet 1">Maecenas ut sagittis mi. Vestibulum faucibus ligula sit amet facilisis pulvinar. Morbi mollis odio id est consequat, a convallis quam finibus. Morbi id congue turpis, sit amet ultrices tortor. Phasellus vel nisi.</Div>
<Div custom-style = "Bullet 1">Quisque iaculis congue aliquet. Aenean in dictum nisl. Etiam quis ullamcorper ex. Aenean mollis ante eget.</Div>

<Div custom-style = "Table or chart caption">Table or chart caption</Div>
```{r flextable-table-data, ft.align = "left"}
# Set up some formatting for flextable to be applied to most tables
my_ft_format <- function(ft) {
  ft |>
    bold(part = "header") |>
    bg(bg = "#43358B", part = "header") |>
    color(color = "white", part = "header") |>
    align(align = "left", part = "header") |>
    valign(valign = "center", part = "header") |>
    valign(valign = "top", part = "body") |>
    colformat_num(big.mark = "") |>
    fontsize(size = 12, part = "all") |>
    border(border = fp_border_default(color = "#000000", width = 0.5),
           part = "all")
}

headings <- list("Table head", "Table head", "Table head", "Table head",
                 "Table head")

```

## Table format has been set... 

## Now to make a specific table... 

```{r qpi_summary_table}
names(headings) <- names(performance_by_year)

flextable(performance_by_year, theme_fun = NULL) |>
  my_ft_format() |>
  set_header_labels(values = headings) |>
  bold(i = nrow(table_data)) |>
  align(j = 2, align = "right", part = "body") |>
  height(height = 0.236, part = "body") |>
  hrule(rule = "atleast", part = "body") |>
  width(width = 1.26)
```

<br>



Maecenas bibendum consequat vehicula. Fusce id viverra lorem, et

<Div custom-style = "Bullet 1">Curabitur luctus luctus lorem, at commodo mauris rutrum quis. Mauris aliquet turpis vel magna bibendum hendrerit. Nulla finibus porta sapien ut pretium. Aliquam elementum mauris.</Div>
<Div custom-style = "Bullet 1">Vivamus bibendum ut tellus rhoncus porttitor. Nam id nibh et.</Div>
<Div custom-style = "Bullet 1">Ut in dapibus massa, ut gravida ligula. Vestibulum ut consectetur:</Div>
<Div custom-style = "Bullet 2">Vivamus luctus varius nibh, a scelerisque ex tincidunt non. Etiam dignissim.</Div>
<Div custom-style = "Bullet 2">Curabitur laoreet viverra magna eget dapibus. Maecenas scelerisque euismod mattis. Sed cursus.</Div>
<Div custom-style = "Bullet 2">Sed in iaculis lectus, sed fermentum urna. Donec efficitur diam eu ipsum viverra, eu ornare justo mollis. Phasellus in dictum tellus.</Div>

# Background
Aliquam sed maximus ante, a imperdiet est. Vivamus vel diam facilisis, pulvinar erat consequat, consequat nulla. Praesent lorem dolor, luctus ut libero vitae, venenatis congue tortor.

Nunc at mauris euismod, mattis tellus sed, vehicula dolor. Duis quis auctor elit. Fusce eu dui eu magna convallis porttitor in ac purus. Proin sed tellus massa. In pulvinar augue sit amet faucibus maximus. Aenean porttitor arcu vitae lacus fringilla condimentum. Praesent laoreet, felis non dignissim viverra, libero nunc eleifend sapien, sed dignissim felis risus et tellus.

# Contact
Name | Role | Number | [phs.generic-team-email@phs.scot](mailto:phs.generic-team-email@phs.scot)

Name | Role | Number | [phs.generic-team-email@phs.scot](mailto:phs.generic-team-email@phs.scot)

For all media enquiries please email [phs.comms@phs.scot](mailto:phs.comms@phs.scot) or call 0131 275 6105.

# Further information
Data from this publication are available from the [publication page](https://publichealthscotland.scot/publications/YOUR-PUBLICATION-URL) on our website.

Open data from this publication is available from the [Scottish Health and Social Care Open Data platform](https://www.opendata.nhs.scot/).

Our statistical practice is regulated by the Office for Statistics Regulation (OSR).

Visit our website for [further information about our statistics and PHS as an Official Statistics producer.](https://publichealthscotland.scot/our-organisation/about-our-statistics/official-statistics/)

The next release of this publication will be DD Month YYYY.

Other formats of this publication are available on request by calling 0131 314 5300 or emailing [phs.otherformats@phs.scot](mailto:phs.otherformats@phs.scot).

# NHS Performs
A selection of information from this publication is included in [NHS Performs](http://www.nhsperforms.scot). NHS Performs is a website that brings together a range of information on how hospitals and NHS Boards within NHSScotland are performing.
